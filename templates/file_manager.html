{% extends "base.html" %}

{% block title %}File Manager - {{ app_name }}{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/file_manager.js') }}" defer></script>
{% endblock %}

{% block styles %}
    .folder-toggle { cursor: pointer; }
    .folder-toggle .bi-caret-right-fill { transition: transform 0.2s ease-in-out; }
    .folder-toggle[aria-expanded="true"] .bi-caret-right-fill { transform: rotate(90deg); }
    .file-list-nested { padding-left: 1.5rem; }
    #selection-actions { display: none; }
{% endblock %}

{% block header_icon %}<i class="bi bi-folder-fill"></i>{% endblock %}
{% block header_title %}File Manager{% endblock %}

{% block nav_buttons %}
  <a href="{{ url_for('index_route') }}" class="btn btn-secondary me-3"><i class="bi bi-house-fill"></i> Home</a>
  <a href="{{ url_for('settings_route') }}" class="btn btn-secondary me-3 perm-admin"><i class="bi bi-gear-fill"></i> Settings</a>
{% endblock %}

{% block content %}
<div class="card">
  <div class="card-header">
    <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <div class="form-check me-3">
                <input class="form-check-input" type="checkbox" id="select-all-checkbox" title="Select All">
            </div>
            <span>Downloads Directory</span>
        </div>
        <button class="btn btn-primary btn-sm" id="refresh-btn">
            <i class="bi bi-arrow-clockwise"></i>
            <span class="d-none d-sm-inline ms-1">Refresh</span>
        </button>
    </div>
    <div id="selection-actions" class="mt-2 p-2 rounded bg-body-tertiary">
        <span id="selection-count" class="me-3 text-muted fw-bold"></span>
        <button class="btn btn-success btn-sm me-2 perm-can_download_files" id="download-selected-btn"><i class="bi bi-file-earmark-zip-fill"></i> Download Selected (.zip)</button>
        <button class="btn btn-danger btn-sm perm-can_delete_files" id="delete-selected-btn"><i class="bi bi-trash-fill"></i> Delete Selected</button>
    </div>
  </div>
  <div class="list-group list-group-flush" id="file-list-root">
    <!-- Content is dynamically loaded by file_manager.js -->
  </div>
</div>
{% endblock %}
